
[toc]

# Python3 函数
- 函数是组织好的，可重复使用的，用来实现单一，或相关联功能的代码段。
- 函数能提高应用的模块性，和代码的重复利用率。
- Python提供了许多 *内建函数*，比如print()。
- 但也可以自己创建函数，这被叫做 *用户自定义函数*。

---

## 定义一个函数
定义函数，简单的规则：
- 函数代码块以 def 关键词开头，后接函数标识符名称和圆括号 ()。
- 任何传入参数和自变量必须放在圆括号中间，圆括号之间可以用于定义参数。
- 函数的第一行语句可以选择性地使用文档字符串—用于存放函数说明。
- 函数内容以冒号起始，并且缩进。
- return [表达式] 结束函数，选择性地返回一个值给调用方。不带表达式的return相当于返回 None。

```py
# 定义函数使用 def 关键字:
def 函数名（参数列表）:
    函数体
# 默认情况下，参数值和参数名称是按函数声明中定义的顺序匹配起来的。


>>>def hello() :    #使用函数来输出"Hello World！"：
   print("Hello World!")
>>> hello()
Hello World!


# 更复杂点的应用，函数中带上参数变量:
def area(width, height):
    return width * height
def print_welcome(name):
    print("Welcome", name)

print_welcome("Runoob")
w = 4
h = 5
print("width =", w, " height =", h, " area =", area(w, h))
#输出结果：
Welcome Runoob
width = 4  height = 5  area = 20
```

---

## 函数调用
- 定义函数：给了函数一个名称，指定了函数里包含的参数，和代码块结构。
- 这个函数的基本结构完成以后，你可以通过另一个函数调用执行，也可以直接从 Python 命令提示符执行。

```py
# 实例调用了 printme() 函数：
def printme( str ):        # 定义函数
   print (str)             # 打印任何传入的字符串
   return

# 调用函数
printme("我要调用用户自定义函数!")
printme("再次调用同一函数")
#输出结果：
我要调用用户自定义函数!
再次调用同一函数
```

---

## 参数传递
- 在 python 中，类型属于对象，变量是没有类型的：

```py
a=[1,2,3]
a="Runoob"
# 以上代码中
# [1,2,3] 是 List 类型
# "Runoob" 是 String 类型
# 而变量 a 是没有类型，她仅仅是一个对象的引用（一个指针），可以是指向 List 类型对象，也可以是指向 String 类型对象。
```

### 可更改(mutable)与不可更改(immutable)对象
python 函数的参数传递：
- 不可变类型：类似 c++ 的值传递
  - 如 `strings, tuples, 和 numbers` 是 *不可更改的对象*
  - 变量赋值 a=5 后再赋值 a=10，实际是新生成一个 int 值对象 10，再让 a 指向它，而 5 被丢弃，不是改变a的值，相当于 **新生成了a**。
  - 如fun（a），传递的只是a的值，没有影响a对象本身。
  - 比如在 fun（a）内部修改 a 的值，只是修改另一个复制的对象，不会影响 a 本身。
- 可变类型：类似 c++ 的引用传递
  - 如 `list, dict` 等则是 *可修改的对象*
  - 变量赋值 la=[1,2,3,4] 后再赋值 la[2]=5 则是将 list la 的第三个元素值更改，**本身la没有动，只是其内部的一部分值被修改了**。
  - 如 fun（la），则是将 la 真正的传过去，修改后fun外部的la也会受影响
- python 中一切都是对象，严格意义我们不能说`值传递`还是`引用传递`，我们应该说传`不可变对象`和传`可变对象`。

```py
# 传不可变对象实例
def ChangeInt( a ):
    a = 10

b = 2
ChangeInt(b)
print( b )
# 结果是 2
1. int 对象 2，指向它的变量是 b
2. 传递给 ChangeInt 函数时，按传值的方式复制了变量 b
3. a 和 b 都指向了同一个 Int 对象，在 a=10 时，则新生成一个 int 值对象 10，并让 a 指向它。


# 传可变对象实例
# 可变对象在函数里修改了参数，那么在调用这个函数的函数里，原始的参数也被改变了。
def changeme( mylist ):     # 修改传入的列表
   mylist.append([1,2,3,4])
   print ("函数内取值: ", mylist)
   return

# 调用changeme函数
mylist = [10,20,30]
changeme( mylist )
print ("函数外取值: ", mylist)
# 传入函数的和在末尾添加新内容的对象用的是同一个引用。
# 输出结果
函数内取值:  [10, 20, 30, [1, 2, 3, 4]]
函数外取值:  [10, 20, 30, [1, 2, 3, 4]]
```

---

## 参数
- 以下是调用函数时可使用的正式参数类型：
  - 必需参数     # def printme(`str`)
  - 关键字参数   # def print(`name, age`)
  - 默认参数     # def printinfo( name, `age = 35`)
  - 不定长参数   # def functionname(`[formal_args,] *var_args_tuple`):

---

### 必需参数
- `必需参数`须以正确的顺序传入函数。调用时的数量必须和声明时的一样。

```py

# 调用 printme() 函数，你必须传入一个参数，不然会出现语法错误：
def printme(str):     # 打印任何传入的字符串
   print (str)
   return

printme()             # 调用 printme 函数，不加参数会报错
# 输出结果：
Traceback (most recent call last):
  File "test.py", line 10, in <module>
    printme()
TypeError: printme() missing 1 required positional argument: 'str'
```

---

### 关键字参数
- `关键字参数`和函数调用关系紧密，函数调用使用关键字参数来确定传入的参数值。
- 使用关键字参数 **允许函数调用时参数的顺序与声明时不一致**，因为 Python 解释器能够用参数名匹配参数值。

```py

# 在函数 printme() 调用时使用参数名：
def printme( str ):         # 打印任何传入的字符串
   print (str)
   return
printme( str = "菜鸟教程")
# 输出结果：
菜鸟教程


# 函数参数的使用不需要使用指定顺序：
def printinfo( name, age ):            # 打印任何传入的字符串
   print ("名字: ", name)
   print ("年龄: ", age)
   return

printinfo( age=50, name="runoob" )
#输出结果：
名字:  runoob
年龄:  50
```

---

### 默认参数
- 调用函数时，如果没有传递参数，则会使用默认参数。

```py

# 以下实例中如果没有传入 age 参数，则使用默认值：
def printinfo( name, age = 35 ):
   print ("名字: ", name)
   print ("年龄: ", age)
   return

printinfo( age=50, name="runoob" )
print ("------------------------")
printinfo( name="runoob" )
# 输出结果：
名字:  runoob
年龄:  50
------------------------
名字:  runoob
年龄:  35
```

---

### 不定长参数
- 你可能需要一个函数能处理比当初声明时更多的参数。这些参数叫做不定长参数
- 和上述 2 种参数不同，声明时不会命名。

```py

#--------------------------------------------------
# 基本语法
def functionname([formal_args,] *var_args_tuple ):       # 函数_文档字符串
   function_suite
   return [expression]
#--------------------------------------------------


#--------------------------------------------------
# 加了星号 * 的参数会以元组(tuple)的形式导入，存放所有未命名的变量参数。
#--------------------------------------------------
def printinfo( arg1, *vartuple ):      # 打印任何传入的参数
   print ("输出: ")
   print (arg1)
   print (vartuple)
printinfo( 70, 60, 50 )
# 输出结果：
输出:
70
(60, 50)

#--------------------------------------------------
# 如果在函数调用时没有指定参数，它就是一个空元组。
#--------------------------------------------------
# 也可以不向函数传递未命名的变量。如下实例：
def printinfo( arg1, *vartuple ):                       # 打印任何传入的参数
   print ("输出: ")
   print (arg1)
   for var in vartuple:
      print (var)
   return
printinfo( 10 )
printinfo( 70, 60, 50 )
# 输出结果：
输出:
10
输出:
70
60
50


#--------------------------------------------------
# if 参数带两个星号 **
def functionname([formal_args,] **var_args_dict ):
   function_suite
   return [expression]
#--------------------------------------------------
# 加了两个星号 ** 的参数会以字典的形式导入。
def printinfo( arg1, **vardict ):
   print ("输出: ")
   print (arg1)
   print (vardict)
printinfo(1, a=2,b=3)
# 输出:
输出:
1
{'a': 2, 'b': 3}


#--------------------------------------------------
# 参数中星号 * 可以单独出现
#--------------------------------------------------
def f(a,b,*,c):           # 如果单独出现星号 *
     return a+b+c         # * 后的参数必须用关键字传入。

>>> f(1,2,c=3) # 正常      # * 后的参数必须用关键字传入。
6

>>> f(1,2,3)   # 报错
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: f() takes 2 positional arguments but 3 were given
```

---

### 匿名函数
- 匿名函数: *不使用 def 语句* 这样标准的形式定义一个函数。
- python 使用 `lambda` 来创建匿名函数。
- lambda:
  - 只是一个表达式，函数体比 def 简单很多。
  - lambda的主体是一个表达式，而不是一个代码块。仅仅能在lambda表达式中封装有限的逻辑进去。
  - lambda 函数拥有自己的命名空间，且不能访问自己参数列表之外或全局命名空间里的参数。
  - 虽然lambda函数看起来只能写一行，却不等同于C或C++的内联函数，后者的目的是调用小函数时不占用栈内存从而增加运行效率。
语法

```py

#--------------------------------------------------
# lambda 函数的语法只包含一个语句:
lambda [arg1 [,arg2,.....argn]]:expression

# 实例：
sum = lambda arg1, arg2: arg1 + arg2
print ("相加后的值为 : ", sum( 10, 20 ))      # 调用sum函数
print ("相加后的值为 : ", sum( 20, 20 ))
# 输出结果：
相加后的值为 :  30
相加后的值为 :  40
```

---

### return语句
- return [表达式] 语句用于退出函数，选择性地向调用方返回一个表达式。
- 不带参数值的return语句返回None。

```py

# 返回数值，return 语句的用法：
def sum( arg1, arg2 ):           # 返回2个参数的和."
   total = arg1 + arg2
   print ("函数内 : ", total)
   return total

total = sum( 10, 20 )       # 调用sum函数
print ("函数外 : ", total)
# 输出结果：
函数内 :  30
函数外 :  30
```

---

### 强制位置参数
- Python3.8 新增了一个函数形参语法
- 用来指明函数形参, 必须使用指定位置参数，不能使用关键字参数的形式。

```py
# 在以下的例子中，形参 a&b 必须使用`指定位置参数`，c/d 可以是`位置形参`或`关键字形参`，而 e/f 要求为`关键字形参`:

def f(a, b, /, c, d, *, e, f):
    print(a, b, c, d, e, f)
# 以下使用方法是正确的:
f(10, 20, 30, d=40, e=50, f=60)
# 以下使用方法会发生错误:
f(10, b=20, c=30, d=40, e=50, f=60)   # b 不能使用关键字参数的形式
f(10, 20, 30, 40, 50, f=60)           # e 必须使用关键字参数的形式
```
